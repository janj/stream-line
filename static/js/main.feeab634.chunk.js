(this["webpackJsonpstream-line"]=this["webpackJsonpstream-line"]||[]).push([[0],{263:function(e,t){},378:function(e,t,n){},379:function(e,t,n){},384:function(e,t){},385:function(e,t){},706:function(e,t){},760:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(23),c=n.n(i),s=(n(378),n(5)),u=n(13),o=(n(379),n(36)),l=n(806),j=n(132),d=n(47),p=n.n(d),f=n(71);function h(e){return b.apply(this,arguments)}function b(){return(b=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.onload=function(n){var a,r=null===(a=n.target)||void 0===a?void 0:a.result;e({name:t.name,data:r})},a.onerror=n,a.readAsBinaryString(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.reduce((function(e,t){return e.then((function(e){return h(t).then((function(t){var n=t.name,a=t.data;return e[n]=a,e}))}))}),Promise.resolve({})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(183),v={Artist:["artist"],ContentType:["content type"],DeliveryMethod:["delivery method"],Distributor:["distributor","store"],ISRC:["isrc"],Label:["label"],PeriodFrom:["period from","sales start date"],PeriodTo:["period to","sales end date"],Quantity:["quantity","total plays"],ReleaseTitle:["release title","album name"],Revenue:["revenue","amount"],Territory:["territory","country iso"],TrackTitle:["track title","track name"],Date:["date"],UPC:["upc","ean/upc"],CountryName:["country name"],TotalDownloads:["total downloads"],AmountCurrency:["amount currency"],Ignore:["cat. no.","suitebeats comp."]};function x(e){var t={};return Object.keys(e).forEach((function(n){var a=Object.keys(v).find((function(e){return v[e].includes(n.toLowerCase())}));a?"Ignore"!==a&&(t[a]=e[n]):console.log("not mapping:",n,e[n])})),t}var y=["Period From","Period To","Transaction Data","Distributor","UPC","Cat. No.","ISRC","Label","Release Title","Track Title","Mix Name","Artist","Content Type","Delivery Method","Territory","Quantity","Revenue","Sales Start Date","Sales End Date","EAN/UPC","Album Name","Track Name","Store","Country Name","Country ISO","Total Plays","Total Downloads","Amount","Amount Currency"];function g(e,t){var n={};return t.forEach((function(t){!n[t[e]]&&(n[t[e]]=[]),n[t[e]].push(t)})),n}var S=n(4);function w(e){var t=e.label,n=e.onLoad,a=r.a.useState(!1),i=Object(s.a)(a,2),c=i[0],u=i[1],o=r.a.useState([]),d=Object(s.a)(o,2),p=d[0],f=d[1];return c?Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(j.a,{variant:"contained",component:"label",children:["Select Files",Object(S.jsx)("input",{type:"file",onChange:function(e){f(Array.from(e.target.files))},hidden:!0,multiple:!0})]}),!!p.length&&Object(S.jsxs)(l.a,{border:"1px solid",padding:"5px",children:[Object(S.jsx)(l.a,{children:"Selected Files:"}),Object(S.jsxs)(l.a,{padding:"5px",children:[p.map((function(e,t){return Object(S.jsx)(l.a,{children:e.name},t)})),Object(S.jsx)(l.a,{children:Object(S.jsx)(j.a,{onClick:function(){(function(e){return O.apply(this,arguments)})(p).then(n).then((function(){return u(!1)}))},children:t||"DoIt"})})]})]})]}):Object(S.jsx)(l.a,{children:Object(S.jsx)(j.a,{variant:"contained",component:"label",onClick:function(){return u(!0)},children:"Select Files"})})}function k(e){var t=e.onStatementsSelect,n=e.label;return Object(S.jsx)(w,{onLoad:function(e){var n=Object.values(e).reduce((function(e,t){return e.push.apply(e,Object(o.a)(function(e){var t=m.read(e,{type:"binary"}),n=t.SheetNames[0],a=t.Sheets[n],r=m.utils.decode_range(a["!ref"]),i=m.utils.sheet_to_csv(a,{RS:"\n"}),c=-1;if(i.split("\n").forEach((function(e,t){if(!(c>=0)){var n=e.split(",").filter((function(e){return!!e}));n.filter((function(e){return y.includes(e)})).length>n.length/2&&(c=t)}})),c<0)throw new Error("header row not found");return m.utils.sheet_to_json(a,{range:{s:{c:0,r:c},e:r.e}}).map(x)}(t))),e}),[]);t(n)},label:n})}var A=n(347);function C(e){var t=e.sheet,n=g("ISRC",t),a=Object.keys(n).map((function(e,t){var a={id:t};return n[e].forEach((function(e){a.title=e.TrackTitle,!a.quantity&&(a.quantity=0),a.quantity+=e.Quantity,!a.revenue&&(a.revenue=0),a.revenue+=e.Revenue,a.artist=e.Artist})),a}));return Object(S.jsx)("div",{style:{height:300,width:"100%"},children:Object(S.jsx)(A.a,{rows:a,columns:[{field:"title",headerName:"Title",width:150},{field:"artist",headerName:"Artist",width:150},{field:"quantity",headerName:"Quantity",width:150},{field:"revenue",headerName:"Revenue",width:150}]})})}var T=n(220),N=n.n(T),E=n(221),R=n(84),U="all",D=["streams","revenue"];function F(e){var t=e.sheet,n=e.onFiltersChanged,a=r.a.useState(""),i=Object(s.a)(a,2),c=i[0],u=i[1],o=r.a.useState(""),j=Object(s.a)(o,2),d=j[0],p=j[1],f=r.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1];return r.a.useEffect((function(){var e=[];t.forEach((function(t){t.Artist&&!e.includes(t.Artist)&&e.push(t.Artist)})),O(e),u(U),p(D[0])}),[t]),r.a.useEffect((function(){n({artist:c,streamOrRevenue:d})}),[d,c,n]),Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(E.a,{value:c,onChange:function(e){return u(e.target.value)},style:{padding:6,margin:6},children:[Object(S.jsx)(R.a,{value:U,children:"All"}),b.map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))]}),Object(S.jsx)(E.a,{value:d,onChange:function(e){return p(e.target.value)},style:{padding:6,margin:6},children:D.map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))})]})}function B(e){var t=e.sheet,n=r.a.useState({}),a=Object(s.a)(n,2),i=a[0],c=a[1],u=r.a.useState([]),o=Object(s.a)(u,2),j=o[0],d=o[1],p=r.a.useState([]),f=Object(s.a)(p,2),h=f[0],b=f[1],O=r.a.useState(""),m=Object(s.a)(O,2),v=m[0],x=m[1],y=r.a.useState({}),w=Object(s.a)(y,2),k=w[0],A=w[1],C=r.a.useState(""),T=Object(s.a)(C,2),E=T[0],R=T[1];r.a.useEffect((function(){var e=g("Distributor",t),n=[];Object.keys(e).forEach((function(e){n.push(e)})),c(e),b(n)}),[t]),r.a.useEffect((function(){var e=[],t=[];Object.keys(i).forEach((function(n){var a=0,r=0;i[n].forEach((function(e){v!==U&&v!==e.Artist||(a+=e.Revenue,r+=e.Quantity)})),e.push(a),t.push(r)})),A({revenue:e,streams:t}),d([{data:t}])}),[v,i]),r.a.useEffect((function(){k[E]&&d([{data:k[E]}])}),[E,k]);var D={chart:{type:"bar",height:350},plotOptions:{bar:{borderRadius:4,horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:h}};return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;x(t),R(n)}}),Object(S.jsx)(N.a,{options:D,series:j,type:"bar",height:350})]})}function I(e){var t=e.sheet,n=r.a.useState({}),a=Object(s.a)(n,2),i=a[0],c=a[1],u=r.a.useState([]),j=Object(s.a)(u,2),d=j[0],p=j[1],f=r.a.useState(""),h=Object(s.a)(f,2),b=h[0],O=h[1],m=r.a.useState(""),v=Object(s.a)(m,2),x=v[0],y=v[1],w=r.a.useState([]),k=Object(s.a)(w,2),A=k[0],C=k[1],T=r.a.useState({}),E=Object(s.a)(T,2),R=E[0],D=E[1];r.a.useEffect((function(){var e=function(e){return g("Territory",e)}(t);p(Object.keys(e)),c(e)}),[t]),r.a.useEffect((function(){var e=[],t=[];Object.keys(i).forEach((function(n){var a=0,r=0;i[n].forEach((function(e){b!==U&&b!==e.Artist||(a+=e.Revenue,r+=e.Quantity)})),e.push(a),t.push(r)})),D({revenue:e,streams:t})}),[b,i]),r.a.useEffect((function(){R[x]&&C(Object(o.a)(R[x]))}),[x,R]);return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;O(t),y(n)}}),Object(S.jsx)(N.a,{options:{chart:{type:"donut"},labels:d,responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},series:A,type:"donut",height:350+Math.floor(2*Math.random())+1})]})}var P=n(65),L=n(66),M=n(130),Q=n(129),q=n(55),J=n.n(q),_=function(){function e(t){Object(P.a)(this,e),this.parseObj=void 0,this.parseObj=t}return Object(L.a)(e,[{key:"id",get:function(){return this.parseObj.id}}]),e}(),Y="ArtistMapping",z=function(e){Object(M.a)(n,e);var t=Object(Q.a)(n);function n(e,a){var r;return Object(P.a)(this,n),(r=t.call(this,e)).artist=void 0,r.artist=a,r}return Object(L.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}},{key:"mappedTo",get:function(){return this.artist}}]),n}(_);function K(e){return H.apply(this,arguments)}function H(){return(H=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reduce((function(e,t){return e[t.id]=t,e}),{}),a=new J.a.Query(Y),e.abrupt("return",a.find().then((function(e){return e.reduce((function(e,t){var a=new z(t,n[t.get("mappedTo").id]);return e[a.name]=a,e}),{})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(f.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.mappedTo,r=new J.a.Object(Y,{name:n,mappedTo:a.parseObj}),e.abrupt("return",r.save().then((function(e){return new z(e,a)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X="Artist",Z=function(e){Object(M.a)(n,e);var t=Object(Q.a)(n);function n(){return Object(P.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}}]),n}(_);function G(){return V.apply(this,arguments)}function V(){return(V=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new J.a.Query(X),e.abrupt("return",t.find().then((function(e){return e.map((function(e){return new Z(e)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=new J.a.Object(X,{name:n}),e.abrupt("return",a.save().then((function(e){return new Z(e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){var e=r.a.useState([]),t=Object(s.a)(e,2),n=t[0],a=t[1],i=r.a.useState(),c=Object(s.a)(i,2),u=c[0],o=c[1];if(r.a.useState((function(){G().then((function(e){K(e).then(o)}))})),!u)return Object(S.jsx)(l.a,{children:"Loading..."});return Object(S.jsxs)(l.a,{style:{padding:25},children:[Object(S.jsx)(l.a,{style:{padding:25},children:Object(S.jsx)(k,{onStatementsSelect:function(e){a(u?function(e,t){return e.map((function(e){var n;return e.Artist=(null===(n=t[e.Artist])||void 0===n?void 0:n.mappedTo.name)||e.Artist,e}))}(e,u):e)}})}),!!n.length&&Object(S.jsxs)(l.a,{style:{padding:25,border:"solid 1px"},children:["Tracks",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(C,{sheet:n})}),"Retailers",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(B,{sheet:n})}),"Locations",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(I,{sheet:n})})]})]})}var te=n(252),ne=function(){var e=Object(f.a)(p.a.mark((function e(t){var n,a,r,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,r=n,i=a,e.prev=3,e.next=6,J.a.User.signUp(r,i,{});case 6:return c=e.sent,alert("Success! User ".concat(c.getUsername()," was successfully created!")),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),alert("Error! ".concat(e.t0)),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();function ae(e){var t=e.manager,n=e.statementArtists,a=r.a.useState({}),i=Object(s.a)(a,2),c=i[0],u=i[1],o=r.a.useState({}),j=Object(s.a)(o,2),d=j[0],p=j[1],f=r.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1],m=r.a.useCallback((function(){var e=t.sortNames(n),a=e.artists,r=e.mapped,i=e.neither;p(a),u(r),O(i)}),[t,n]);return r.a.useEffect((function(){m()}),[m]),Object(S.jsxs)(l.a,{children:[Object(S.jsx)(ce,{names:b,manager:t,onUpdate:m}),Object(S.jsx)(re,{artists:d}),Object(S.jsx)(ie,{mappings:c})]})}function re(e){var t=e.artists;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Artists"})}),Object(S.jsx)(l.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(S.jsx)(l.a,{children:e.name})}))})]})}function ie(e){var t=e.mappings;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Mappings"})}),Object(S.jsx)(l.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(S.jsxs)(l.a,{children:[e.name,Object(S.jsx)("b",{children:" MAPPED TO: "}),e.mappedTo.name]})}))})]})}function ce(e){var t=e.names,n=e.manager,a=e.onUpdate;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Unknown Artists"})}),Object(S.jsx)(l.a,{padding:"10px",children:t.map((function(e){return Object(S.jsx)(se,{manager:n,name:e,onUpdate:a})}))})]})}function se(e){var t=e.name,n=e.manager,a=e.onUpdate,i=r.a.useState(!1),c=Object(s.a)(i,2),u=c[0],o=c[1];return Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(l.a,{children:[t,Object(S.jsx)(j.a,{onClick:function(){n.createArtist({name:t}).then(a)},children:"Import"}),Object(S.jsx)(j.a,{onClick:function(){return o(!0)},children:"Map To Existing"})]}),u&&Object(S.jsx)(ue,{manager:n,onSelect:function(e){n.createMapping({name:t,mappedTo:e}).then(a)}})]})}function ue(e){var t=e.manager,n=e.onSelect,a=r.a.useState(),i=Object(s.a)(a,2),c=i[0],u=i[1];return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(E.a,{value:c,onChange:function(e){return u(e.target.value)},children:Object.keys(t.artistsByName).map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))}),c&&Object(S.jsx)(j.a,{onClick:function(){return n(t.artistForName(c))},children:"Map It"})]})}var oe=function(){function e(t,n){Object(P.a)(this,e),this.artistsByName=void 0,this.mappingsByName=void 0,this.artistsByName=t.reduce((function(e,t){return e[t.name]=t,e}),{}),this.mappingsByName=n}return Object(L.a)(e,[{key:"createArtist",value:function(e){var t=this;return function(e){return $.apply(this,arguments)}(e).then((function(e){return t.artistsByName[e.name]=e,e}))}},{key:"createMapping",value:function(e){var t=this;return function(e){return W.apply(this,arguments)}(e).then((function(e){return t.mappingsByName[e.name]=e,e}))}},{key:"artistForName",value:function(e){return this.artistsByName[e]}},{key:"mappingForName",value:function(e){return this.mappingsByName[e]}},{key:"sortNames",value:function(e){var t=this;return e.reduce((function(e,n){var a=e.artists,r=e.mapped,i=e.neither;return t.artistsByName[n]?a[n]=t.artistsByName[n]:t.mappingsByName[n]?r[n]=t.mappingsByName[n]:i.push(n),{artists:a,mapped:r,neither:i}}),{artists:{},mapped:{},neither:[]})}}]),e}();var le={login:function(){var e=r.a.useState(""),t=Object(s.a)(e,2),n=t[0],a=t[1],i=r.a.useState(""),c=Object(s.a)(i,2),u=c[0],o=c[1],d=J.a.User.current();return d?Object(S.jsxs)(l.a,{children:["Hi ",d.getUsername()]}):Object(S.jsxs)(l.a,{children:[Object(S.jsx)(l.a,{children:"Login"}),Object(S.jsxs)(l.a,{children:["Username",Object(S.jsx)(te.a,{value:n,onChange:function(e){return a(e.target.value)}})]}),Object(S.jsxs)(l.a,{children:["Password",Object(S.jsx)(te.a,{value:u,onChange:function(e){return o(e.target.value)}})]}),Object(S.jsx)(l.a,{children:Object(S.jsx)(j.a,{onClick:function(){return ne({username:n,password:u})},children:"Signup"})})]})},artists:function(){var e=r.a.useState([]),t=Object(s.a)(e,2),n=t[0],a=t[1],i=r.a.useState(),c=Object(s.a)(i,2),u=c[0],o=c[1];return r.a.useEffect((function(){G().then((function(e){return K(e).then((function(t){o(new oe(e,t))}))}))}),[]),u?Object(S.jsxs)(l.a,{children:[Object(S.jsx)(l.a,{children:"Artist Management"}),Object(S.jsx)(l.a,{children:Object(S.jsx)(k,{label:"Import File Data",onStatementsSelect:function(e){a(function(e){return Array.from(new Set(e.map((function(e){return e.Artist}))))}(e))}})}),Object(S.jsx)(ae,{manager:u,statementArtists:n})]}):Object(S.jsx)(l.a,{children:"Loading..."})}},je=["artists"];function de(){for(var e=function(){var e=Object(u.e)().search;return r.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=J.a.User.current(),n=0,a=Object.entries(le);n<a.length;n++){var i=Object(s.a)(a[n],2),c=i[0],o=i[1];if(e.has(c)&&(t||!je.includes(c)))return o}return ee}var pe=function(){var e=de();return Object(S.jsx)(l.a,{className:"App",padding:"35px",children:Object(S.jsx)(e,{})})},fe=n(248),he=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,809)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};J.a.initialize("ynIkTAKDSN7mx79IDrjsSm7yJJU43RsJe3fg3YKs","2rY3C47KmEDJ5ja3QmtObRzIYIL4dXYZ72A9Eq4W"),J.a.serverURL="https://parseapi.back4app.com/",c.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(fe.a,{children:Object(S.jsx)(u.c,{children:Object(S.jsx)(u.a,{path:"/stream-line",element:Object(S.jsx)(pe,{})})})})}),document.getElementById("root")),he(console.log)}},[[760,1,2]]]);
//# sourceMappingURL=main.feeab634.chunk.js.map