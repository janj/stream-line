(this["webpackJsonpstream-line"]=this["webpackJsonpstream-line"]||[]).push([[0],{263:function(e,t){},378:function(e,t,n){},379:function(e,t,n){},384:function(e,t){},385:function(e,t){},706:function(e,t){},760:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),i=n.n(c),s=(n(378),n(5)),u=n(13),o=(n(379),n(37)),l=n(806),p=n(132),j=n(24),d=n.n(j),f=n(49);function h(e){return b.apply(this,arguments)}function b(){return(b=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(n){var r,a=null===(r=n.target)||void 0===r?void 0:r.result;e({name:t.name,data:a})},r.onerror=n,r.readAsBinaryString(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.reduce((function(e,t){return e.then((function(e){return h(t).then((function(t){var n=t.name,r=t.data;return e[n]=r,e}))}))}),Promise.resolve({})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(183),v={Artist:["artist"],ContentType:["content type"],DeliveryMethod:["delivery method"],Distributor:["distributor","store"],ISRC:["isrc"],Label:["label"],PeriodFrom:["period from","sales start date"],PeriodTo:["period to","sales end date"],Quantity:["quantity","total plays"],ReleaseTitle:["release title","album name"],Revenue:["revenue","amount"],Territory:["territory","country iso"],TrackTitle:["track title","track name"],Date:["date"],UPC:["upc","ean/upc"],CountryName:["country name"],TotalDownloads:["total downloads"],AmountCurrency:["amount currency"],Ignore:["cat. no.","suitebeats comp."]};function x(e){var t={};return Object.keys(e).forEach((function(n){var r=Object.keys(v).find((function(e){return v[e].includes(n.toLowerCase())}));r?"Ignore"!==r&&(t[r]=e[n]):console.log("not mapping:",n,e[n])})),t}var y=["Period From","Period To","Transaction Data","Distributor","UPC","Cat. No.","ISRC","Label","Release Title","Track Title","Mix Name","Artist","Content Type","Delivery Method","Territory","Quantity","Revenue","Sales Start Date","Sales End Date","EAN/UPC","Album Name","Track Name","Store","Country Name","Country ISO","Total Plays","Total Downloads","Amount","Amount Currency"];function g(e,t){var n={};return t.forEach((function(t){!n[t[e]]&&(n[t[e]]=[]),n[t[e]].push(t)})),n}var S=n(3);function w(e){var t=e.label,n=e.onLoad,r=a.a.useState(!1),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState([]),j=Object(s.a)(o,2),d=j[0],f=j[1];return i?Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(p.a,{variant:"contained",component:"label",children:["Select Files",Object(S.jsx)("input",{type:"file",onChange:function(e){f(Array.from(e.target.files))},hidden:!0,multiple:!0})]}),!!d.length&&Object(S.jsxs)(l.a,{border:"1px solid",padding:"5px",children:[Object(S.jsx)(l.a,{children:"Selected Files:"}),Object(S.jsxs)(l.a,{padding:"5px",children:[d.map((function(e,t){return Object(S.jsx)(l.a,{children:e.name},t)})),Object(S.jsx)(l.a,{children:Object(S.jsx)(p.a,{onClick:function(){(function(e){return O.apply(this,arguments)})(d).then(n).then((function(){return u(!1)}))},children:t||"DoIt"})})]})]})]}):Object(S.jsx)(l.a,{children:Object(S.jsx)(p.a,{variant:"contained",component:"label",onClick:function(){return u(!0)},children:"Select Files"})})}function k(e){var t=e.onStatementsSelect,n=e.label;return Object(S.jsx)(w,{onLoad:function(e){var n=Object.values(e).reduce((function(e,t){return e.push.apply(e,Object(o.a)(function(e){var t=m.read(e,{type:"binary"}),n=t.SheetNames[0],r=t.Sheets[n],a=m.utils.decode_range(r["!ref"]),c=m.utils.sheet_to_csv(r,{RS:"\n"}),i=-1;if(c.split("\n").forEach((function(e,t){if(!(i>=0)){var n=e.split(",").filter((function(e){return!!e}));n.filter((function(e){return y.includes(e)})).length>n.length/2&&(i=t)}})),i<0)throw new Error("header row not found");return m.utils.sheet_to_json(r,{range:{s:{c:0,r:i},e:a.e}}).map(x)}(t))),e}),[]);t(n)},label:n})}var C=n(347);function A(e){var t=e.sheet,n=g("ISRC",t),r=Object.keys(n).map((function(e,t){var r={id:t};return n[e].forEach((function(e){r.title=e.TrackTitle,!r.quantity&&(r.quantity=0),r.quantity+=e.Quantity,!r.revenue&&(r.revenue=0),r.revenue+=e.Revenue,r.artist=e.Artist})),r}));return Object(S.jsx)("div",{style:{height:300,width:"100%"},children:Object(S.jsx)(C.a,{rows:r,columns:[{field:"title",headerName:"Title",width:150},{field:"artist",headerName:"Artist",width:150},{field:"quantity",headerName:"Quantity",width:150},{field:"revenue",headerName:"Revenue",width:150}]})})}var T=n(220),E=n.n(T),N=n(221),R=n(84),U="all",D=["streams","revenue"];function F(e){var t=e.sheet,n=e.onFiltersChanged,r=a.a.useState(""),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState(""),p=Object(s.a)(o,2),j=p[0],d=p[1],f=a.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1];return a.a.useEffect((function(){var e=[];t.forEach((function(t){t.Artist&&!e.includes(t.Artist)&&e.push(t.Artist)})),O(e),u(U),d(D[0])}),[t]),a.a.useEffect((function(){n({artist:i,streamOrRevenue:j})}),[j,i,n]),Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(N.a,{value:i,onChange:function(e){return u(e.target.value)},style:{padding:6,margin:6},children:[Object(S.jsx)(R.a,{value:U,children:"All"}),b.map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))]}),Object(S.jsx)(N.a,{value:j,onChange:function(e){return d(e.target.value)},style:{padding:6,margin:6},children:D.map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))})]})}function I(e){var t=e.sheet,n=a.a.useState({}),r=Object(s.a)(n,2),c=r[0],i=r[1],u=a.a.useState([]),o=Object(s.a)(u,2),p=o[0],j=o[1],d=a.a.useState([]),f=Object(s.a)(d,2),h=f[0],b=f[1],O=a.a.useState(""),m=Object(s.a)(O,2),v=m[0],x=m[1],y=a.a.useState({}),w=Object(s.a)(y,2),k=w[0],C=w[1],A=a.a.useState(""),T=Object(s.a)(A,2),N=T[0],R=T[1];a.a.useEffect((function(){var e=g("Distributor",t),n=[];Object.keys(e).forEach((function(e){n.push(e)})),i(e),b(n)}),[t]),a.a.useEffect((function(){var e=[],t=[];Object.keys(c).forEach((function(n){var r=0,a=0;c[n].forEach((function(e){v!==U&&v!==e.Artist||(r+=e.Revenue,a+=e.Quantity)})),e.push(r),t.push(a)})),C({revenue:e,streams:t}),j([{data:t}])}),[v,c]),a.a.useEffect((function(){k[N]&&j([{data:k[N]}])}),[N,k]);var D={chart:{type:"bar",height:350},plotOptions:{bar:{borderRadius:4,horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:h}};return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;x(t),R(n)}}),Object(S.jsx)(E.a,{options:D,series:p,type:"bar",height:350})]})}function L(e){var t=e.sheet,n=a.a.useState({}),r=Object(s.a)(n,2),c=r[0],i=r[1],u=a.a.useState([]),p=Object(s.a)(u,2),j=p[0],d=p[1],f=a.a.useState(""),h=Object(s.a)(f,2),b=h[0],O=h[1],m=a.a.useState(""),v=Object(s.a)(m,2),x=v[0],y=v[1],w=a.a.useState([]),k=Object(s.a)(w,2),C=k[0],A=k[1],T=a.a.useState({}),N=Object(s.a)(T,2),R=N[0],D=N[1];a.a.useEffect((function(){var e=function(e){return g("Territory",e)}(t);d(Object.keys(e)),i(e)}),[t]),a.a.useEffect((function(){var e=[],t=[];Object.keys(c).forEach((function(n){var r=0,a=0;c[n].forEach((function(e){b!==U&&b!==e.Artist||(r+=e.Revenue,a+=e.Quantity)})),e.push(r),t.push(a)})),D({revenue:e,streams:t})}),[b,c]),a.a.useEffect((function(){R[x]&&A(Object(o.a)(R[x]))}),[x,R]);return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;O(t),y(n)}}),Object(S.jsx)(E.a,{options:{chart:{type:"donut"},labels:j,responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},series:C,type:"donut",height:350+Math.floor(2*Math.random())+1})]})}var B=n(66),P=n(67),M=n(130),Q=n(129),q=n(48),J=n.n(q),_=function(){function e(t){Object(B.a)(this,e),this.parseObj=void 0,this.parseObj=t}return Object(P.a)(e,[{key:"id",get:function(){return this.parseObj.id}}]),e}(),Y="ArtistMapping",z=function(e){Object(M.a)(n,e);var t=Object(Q.a)(n);function n(e,r){var a;return Object(B.a)(this,n),(a=t.call(this,e)).artist=void 0,a.artist=r,a}return Object(P.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}},{key:"mappedTo",get:function(){return this.artist}}]),n}(_);function K(e){return H.apply(this,arguments)}function H(){return(H=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reduce((function(e,t){return e[t.id]=t,e}),{}),r=new J.a.Query(Y),e.abrupt("return",r.find().then((function(e){return e.reduce((function(e,t){var r=new z(t,n[t.get("mappedTo").id]);return e[r.name]=r,e}),{})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(f.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.mappedTo,a=new J.a.Object(Y,{name:n,mappedTo:r.parseObj}),e.abrupt("return",a.save().then((function(e){return new z(e,r)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X="Artist",Z=function(e){Object(M.a)(n,e);var t=Object(Q.a)(n);function n(){return Object(B.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}}]),n}(_);function G(){return V.apply(this,arguments)}function V(){return(V=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new J.a.Query(X),e.abrupt("return",t.find().then((function(e){return e.map((function(e){return new Z(e)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=new J.a.Object(X,{name:n}),e.abrupt("return",r.save().then((function(e){return new Z(e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){var e=a.a.useState([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(),i=Object(s.a)(c,2),u=i[0],o=i[1];if(a.a.useState((function(){G().then((function(e){K(e).then(o)}))})),!u)return Object(S.jsx)(l.a,{children:"Loading..."});return Object(S.jsxs)(l.a,{style:{padding:25},children:[Object(S.jsx)(l.a,{style:{padding:25},children:Object(S.jsx)(k,{onStatementsSelect:function(e){r(u?function(e,t){return e.map((function(e){var n;return e.Artist=(null===(n=t[e.Artist])||void 0===n?void 0:n.mappedTo.name)||e.Artist,e}))}(e,u):e)}})}),!!n.length&&Object(S.jsxs)(l.a,{style:{padding:25,border:"solid 1px"},children:["Tracks",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(A,{sheet:n})}),"Retailers",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(I,{sheet:n})}),"Locations",Object(S.jsx)("div",{style:{padding:25},children:Object(S.jsx)(L,{sheet:n})})]})]})}var te=n(252);function ne(e){return re.apply(this,arguments)}function re(){return(re=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.prev=1,e.next=4,J.a.User.signUp(n,r,{});case 4:return e.next=6,J.a.User.current();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(1),alert("Error! ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function ae(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.prev=1,e.next=4,J.a.User.logIn(n,r);case 4:return e.next=6,J.a.User.current();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(1),alert("Error! ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function ie(){return se.apply(this,arguments)}function se(){return(se=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J.a.User.logOut());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){var t=e.manager,n=e.statementArtists,r=a.a.useState({}),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState({}),p=Object(s.a)(o,2),j=p[0],d=p[1],f=a.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1],m=a.a.useCallback((function(){var e=t.sortNames(n),r=e.artists,a=e.mapped,c=e.neither;d(r),u(a),O(c)}),[t,n]);return a.a.useEffect((function(){m()}),[m]),Object(S.jsxs)(l.a,{children:[Object(S.jsx)(pe,{names:b,manager:t,onUpdate:m}),Object(S.jsx)(oe,{artists:j}),Object(S.jsx)(le,{mappings:i})]})}function oe(e){var t=e.artists;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Artists"})}),Object(S.jsx)(l.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(S.jsx)(l.a,{children:e.name})}))})]})}function le(e){var t=e.mappings;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Mappings"})}),Object(S.jsx)(l.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(S.jsxs)(l.a,{children:[e.name,Object(S.jsx)("b",{children:" MAPPED TO: "}),e.mappedTo.name]})}))})]})}function pe(e){var t=e.names,n=e.manager,r=e.onUpdate;return Object(S.jsxs)(l.a,{border:"solid 1px",padding:"5px",children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("b",{children:"Unknown Artists"})}),Object(S.jsx)(l.a,{padding:"10px",children:t.map((function(e){return Object(S.jsx)(je,{manager:n,name:e,onUpdate:r})}))})]})}function je(e){var t=e.name,n=e.manager,r=e.onUpdate,c=a.a.useState(!1),i=Object(s.a)(c,2),u=i[0],o=i[1];return Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(l.a,{children:[t,Object(S.jsx)(p.a,{onClick:function(){n.createArtist({name:t}).then(r)},children:"Import"}),Object(S.jsx)(p.a,{onClick:function(){return o(!0)},children:"Map To Existing"})]}),u&&Object(S.jsx)(de,{manager:n,onSelect:function(e){n.createMapping({name:t,mappedTo:e}).then(r)}})]})}function de(e){var t=e.manager,n=e.onSelect,r=a.a.useState(),c=Object(s.a)(r,2),i=c[0],u=c[1];return Object(S.jsxs)(l.a,{children:[Object(S.jsx)(N.a,{value:i,onChange:function(e){return u(e.target.value)},children:Object.keys(t.artistsByName).map((function(e){return Object(S.jsx)(R.a,{value:e,children:e},e)}))}),i&&Object(S.jsx)(p.a,{onClick:function(){return n(t.artistForName(i))},children:"Map It"})]})}var fe=function(){function e(t,n){Object(B.a)(this,e),this.artistsByName=void 0,this.mappingsByName=void 0,this.artistsByName=t.reduce((function(e,t){return e[t.name]=t,e}),{}),this.mappingsByName=n}return Object(P.a)(e,[{key:"createArtist",value:function(e){var t=this;return function(e){return $.apply(this,arguments)}(e).then((function(e){return t.artistsByName[e.name]=e,e}))}},{key:"createMapping",value:function(e){var t=this;return function(e){return W.apply(this,arguments)}(e).then((function(e){return t.mappingsByName[e.name]=e,e}))}},{key:"artistForName",value:function(e){return this.artistsByName[e]}},{key:"mappingForName",value:function(e){return this.mappingsByName[e]}},{key:"sortNames",value:function(e){var t=this;return e.reduce((function(e,n){var r=e.artists,a=e.mapped,c=e.neither;return t.artistsByName[n]?r[n]=t.artistsByName[n]:t.mappingsByName[n]?a[n]=t.mappingsByName[n]:c.push(n),{artists:r,mapped:a,neither:c}}),{artists:{},mapped:{},neither:[]})}}]),e}();var he={login:function(){var e=a.a.useState(""),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(""),i=Object(s.a)(c,2),u=i[0],o=i[1],j=a.a.useState(),h=Object(s.a)(j,2),b=h[0],O=h[1];function m(){return(m=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:O(void 0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne({username:n,password:u});case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae({username:n,password:u});case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return a.a.useEffect((function(){O(J.a.User.current())}),[]),a.a.useEffect((function(){r(""),o("")}),[b]),b?Object(S.jsxs)(l.a,{children:[Object(S.jsxs)(l.a,{children:["Hi ",b.getUsername()]}),Object(S.jsx)(l.a,{children:Object(S.jsx)(p.a,{onClick:function(){return m.apply(this,arguments)},children:"Log Out"})})]}):Object(S.jsxs)(l.a,{children:[Object(S.jsx)(l.a,{children:"Login"}),Object(S.jsxs)(l.a,{display:"flex",justifyContent:"center",children:[Object(S.jsx)(l.a,{paddingRight:"10px",children:"Username"}),Object(S.jsx)(te.a,{value:n,onChange:function(e){return r(e.target.value)}})]}),Object(S.jsxs)(l.a,{display:"flex",justifyContent:"center",children:[Object(S.jsx)(l.a,{paddingRight:"10px",children:"Password"}),Object(S.jsx)(te.a,{value:u,onChange:function(e){return o(e.target.value)}})]}),Object(S.jsxs)(l.a,{children:[Object(S.jsx)(p.a,{onClick:function(){return v.apply(this,arguments)},children:"Signup"}),Object(S.jsx)(p.a,{onClick:function(){return x.apply(this,arguments)},children:"Login"})]})]})},artists:function(){var e=a.a.useState([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(),i=Object(s.a)(c,2),u=i[0],o=i[1];return a.a.useEffect((function(){G().then((function(e){return K(e).then((function(t){o(new fe(e,t))}))}))}),[]),u?Object(S.jsxs)(l.a,{children:[Object(S.jsx)(l.a,{children:"Artist Management"}),Object(S.jsx)(l.a,{children:Object(S.jsx)(k,{label:"Import File Data",onStatementsSelect:function(e){r(function(e){return Array.from(new Set(e.map((function(e){return e.Artist}))))}(e))}})}),Object(S.jsx)(ue,{manager:u,statementArtists:n})]}):Object(S.jsx)(l.a,{children:"Loading..."})}},be=["artists"];function Oe(){for(var e=function(){var e=Object(u.e)().search;return a.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=J.a.User.current(),n=0,r=Object.entries(he);n<r.length;n++){var c=Object(s.a)(r[n],2),i=c[0],o=c[1];if(e.has(i)&&(t||!be.includes(i)))return o}return ee}var me=function(){var e=Oe();return Object(S.jsx)(l.a,{className:"App",padding:"35px",children:Object(S.jsx)(e,{})})},ve=n(248),xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,809)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};J.a.initialize("ynIkTAKDSN7mx79IDrjsSm7yJJU43RsJe3fg3YKs","2rY3C47KmEDJ5ja3QmtObRzIYIL4dXYZ72A9Eq4W"),J.a.serverURL="https://parseapi.back4app.com/",i.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(ve.a,{children:Object(S.jsx)(u.c,{children:Object(S.jsx)(u.a,{path:"/stream-line",element:Object(S.jsx)(me,{})})})})}),document.getElementById("root")),xe(console.log)}},[[760,1,2]]]);
//# sourceMappingURL=main.b97ed7ad.chunk.js.map