(this["webpackJsonpstream-line"]=this["webpackJsonpstream-line"]||[]).push([[0],{262:function(e,t){},378:function(e,t,n){},379:function(e,t,n){},384:function(e,t){},385:function(e,t){},706:function(e,t){},760:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),c=n.n(r),i=n(23),s=n.n(i),u=(n(378),n(379),n(36)),o=n(806),j=n(132),l=n(47),d=n.n(l),p=n(71);function f(e){return h.apply(this,arguments)}function h(){return(h=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.onload=function(n){var a,r=null===(a=n.target)||void 0===a?void 0:a.result;e({name:t.name,data:r})},a.onerror=n,a.readAsBinaryString(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.reduce((function(e,t){return e.then((function(e){return f(t).then((function(t){var n=t.name,a=t.data;return e[n]=a,e}))}))}),Promise.resolve({})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=n(183),m={Artist:["artist"],ContentType:["content type"],DeliveryMethod:["delivery method"],Distributor:["distributor","store"],ISRC:["isrc"],Label:["label"],PeriodFrom:["period from","sales start date"],PeriodTo:["period to","sales end date"],Quantity:["quantity","total plays"],ReleaseTitle:["release title","album name"],Revenue:["revenue","amount"],Territory:["territory","country iso"],TrackTitle:["track title","track name"],Date:["date"],UPC:["upc","ean/upc"],CountryName:["country name"],TotalDownloads:["total downloads"],AmountCurrency:["amount currency"],Ignore:["cat. no.","suitebeats comp."]};function v(e){var t={};return Object.keys(e).forEach((function(n){var a=Object.keys(m).find((function(e){return m[e].includes(n.toLowerCase())}));a?"Ignore"!==a&&(t[a]=e[n]):console.log("not mapping:",n,e[n])})),t}var x=["Period From","Period To","Transaction Data","Distributor","UPC","Cat. No.","ISRC","Label","Release Title","Track Title","Mix Name","Artist","Content Type","Delivery Method","Territory","Quantity","Revenue","Sales Start Date","Sales End Date","EAN/UPC","Album Name","Track Name","Store","Country Name","Country ISO","Total Plays","Total Downloads","Amount","Amount Currency"];function y(e,t){var n={};return t.forEach((function(t){!n[t[e]]&&(n[t[e]]=[]),n[t[e]].push(t)})),n}var g=n(3);function S(e){var t=e.label,n=e.onLoad,r=c.a.useState(!1),i=Object(a.a)(r,2),s=i[0],u=i[1],l=c.a.useState([]),d=Object(a.a)(l,2),p=d[0],f=d[1];return s?Object(g.jsxs)(o.a,{children:[Object(g.jsxs)(j.a,{variant:"contained",component:"label",children:["Select Files",Object(g.jsx)("input",{type:"file",onChange:function(e){f(Array.from(e.target.files))},hidden:!0,multiple:!0})]}),!!p.length&&Object(g.jsxs)(o.a,{border:"1px solid",padding:"5px",children:[Object(g.jsx)(o.a,{children:"Selected Files:"}),Object(g.jsxs)(o.a,{padding:"5px",children:[p.map((function(e,t){return Object(g.jsx)(o.a,{children:e.name},t)})),Object(g.jsx)(o.a,{children:Object(g.jsx)(j.a,{onClick:function(){(function(e){return b.apply(this,arguments)})(p).then(n).then((function(){return u(!1)}))},children:t||"DoIt"})})]})]})]}):Object(g.jsx)(o.a,{children:Object(g.jsx)(j.a,{variant:"contained",component:"label",onClick:function(){return u(!0)},children:"Select Files"})})}function w(e){var t=e.onStatementsSelect,n=e.label;return Object(g.jsx)(S,{onLoad:function(e){var n=Object.values(e).reduce((function(e,t){return e.push.apply(e,Object(u.a)(function(e){var t=O.read(e,{type:"binary"}),n=t.SheetNames[0],a=t.Sheets[n],r=O.utils.decode_range(a["!ref"]),c=O.utils.sheet_to_csv(a,{RS:"\n"}),i=-1;if(c.split("\n").forEach((function(e,t){if(!(i>=0)){var n=e.split(",").filter((function(e){return!!e}));n.filter((function(e){return x.includes(e)})).length>n.length/2&&(i=t)}})),i<0)throw new Error("header row not found");return O.utils.sheet_to_json(a,{range:{s:{c:0,r:i},e:r.e}}).map(v)}(t))),e}),[]);t(n)},label:n})}var k=n(346);function A(e){var t=e.sheet,n=y("ISRC",t),a=Object.keys(n).map((function(e,t){var a={id:t};return n[e].forEach((function(e){a.title=e.TrackTitle,!a.quantity&&(a.quantity=0),a.quantity+=e.Quantity,!a.revenue&&(a.revenue=0),a.revenue+=e.Revenue,a.artist=e.Artist})),a}));return Object(g.jsx)("div",{style:{height:300,width:"100%"},children:Object(g.jsx)(k.a,{rows:a,columns:[{field:"title",headerName:"Title",width:150},{field:"artist",headerName:"Artist",width:150},{field:"quantity",headerName:"Quantity",width:150},{field:"revenue",headerName:"Revenue",width:150}]})})}var C=n(220),T=n.n(C),N=n(221),E=n(84),R="all",D=["streams","revenue"];function F(e){var t=e.sheet,n=e.onFiltersChanged,r=c.a.useState(""),i=Object(a.a)(r,2),s=i[0],u=i[1],j=c.a.useState(""),l=Object(a.a)(j,2),d=l[0],p=l[1],f=c.a.useState([]),h=Object(a.a)(f,2),b=h[0],O=h[1];return c.a.useEffect((function(){var e=[];t.forEach((function(t){t.Artist&&!e.includes(t.Artist)&&e.push(t.Artist)})),O(e),u(R),p(D[0])}),[t]),c.a.useEffect((function(){n({artist:s,streamOrRevenue:d})}),[d,s,n]),Object(g.jsxs)(o.a,{children:[Object(g.jsxs)(N.a,{value:s,onChange:function(e){return u(e.target.value)},style:{padding:6,margin:6},children:[Object(g.jsx)(E.a,{value:R,children:"All"}),b.map((function(e){return Object(g.jsx)(E.a,{value:e,children:e},e)}))]}),Object(g.jsx)(N.a,{value:d,onChange:function(e){return p(e.target.value)},style:{padding:6,margin:6},children:D.map((function(e){return Object(g.jsx)(E.a,{value:e,children:e},e)}))})]})}function B(e){var t=e.sheet,n=c.a.useState({}),r=Object(a.a)(n,2),i=r[0],s=r[1],u=c.a.useState([]),j=Object(a.a)(u,2),l=j[0],d=j[1],p=c.a.useState([]),f=Object(a.a)(p,2),h=f[0],b=f[1],O=c.a.useState(""),m=Object(a.a)(O,2),v=m[0],x=m[1],S=c.a.useState({}),w=Object(a.a)(S,2),k=w[0],A=w[1],C=c.a.useState(""),N=Object(a.a)(C,2),E=N[0],D=N[1];c.a.useEffect((function(){var e=y("Distributor",t),n=[];Object.keys(e).forEach((function(e){n.push(e)})),s(e),b(n)}),[t]),c.a.useEffect((function(){var e=[],t=[];Object.keys(i).forEach((function(n){var a=0,r=0;i[n].forEach((function(e){v!==R&&v!==e.Artist||(a+=e.Revenue,r+=e.Quantity)})),e.push(a),t.push(r)})),A({revenue:e,streams:t}),d([{data:t}])}),[v,i]),c.a.useEffect((function(){k[E]&&d([{data:k[E]}])}),[E,k]);var B={chart:{type:"bar",height:350},plotOptions:{bar:{borderRadius:4,horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:h}};return Object(g.jsxs)(o.a,{children:[Object(g.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;x(t),D(n)}}),Object(g.jsx)(T.a,{options:B,series:l,type:"bar",height:350})]})}function I(e){var t=e.sheet,n=c.a.useState({}),r=Object(a.a)(n,2),i=r[0],s=r[1],j=c.a.useState([]),l=Object(a.a)(j,2),d=l[0],p=l[1],f=c.a.useState(""),h=Object(a.a)(f,2),b=h[0],O=h[1],m=c.a.useState(""),v=Object(a.a)(m,2),x=v[0],S=v[1],w=c.a.useState([]),k=Object(a.a)(w,2),A=k[0],C=k[1],N=c.a.useState({}),E=Object(a.a)(N,2),D=E[0],B=E[1];c.a.useEffect((function(){var e=function(e){return y("Territory",e)}(t);p(Object.keys(e)),s(e)}),[t]),c.a.useEffect((function(){var e=[],t=[];Object.keys(i).forEach((function(n){var a=0,r=0;i[n].forEach((function(e){b!==R&&b!==e.Artist||(a+=e.Revenue,r+=e.Quantity)})),e.push(a),t.push(r)})),B({revenue:e,streams:t})}),[b,i]),c.a.useEffect((function(){D[x]&&C(Object(u.a)(D[x]))}),[x,D]);return Object(g.jsxs)(o.a,{children:[Object(g.jsx)(F,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;O(t),S(n)}}),Object(g.jsx)(T.a,{options:{chart:{type:"donut"},labels:d,responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},series:A,type:"donut",height:350+Math.floor(2*Math.random())+1})]})}var U=n(64),P=n(65),L=n(130),M=n(129),Q=n(66),q=n.n(Q),J=function(){function e(t){Object(U.a)(this,e),this.parseObj=void 0,this.parseObj=t}return Object(P.a)(e,[{key:"id",get:function(){return this.parseObj.id}}]),e}(),_="ArtistMapping",Y=function(e){Object(L.a)(n,e);var t=Object(M.a)(n);function n(e,a){var r;return Object(U.a)(this,n),(r=t.call(this,e)).artist=void 0,r.artist=a,r}return Object(P.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}},{key:"mappedTo",get:function(){return this.artist}}]),n}(J);function z(e){return K.apply(this,arguments)}function K(){return(K=Object(p.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reduce((function(e,t){return e[t.id]=t,e}),{}),a=new q.a.Query(_),e.abrupt("return",a.find().then((function(e){return e.reduce((function(e,t){var a=new Y(t,n[t.get("mappedTo").id]);return e[a.name]=a,e}),{})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(p.a)(d.a.mark((function e(t){var n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.mappedTo,r=new q.a.Object(_,{name:n,mappedTo:a.parseObj}),e.abrupt("return",r.save().then((function(e){return new Y(e,a)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X="Artist",Z=function(e){Object(L.a)(n,e);var t=Object(M.a)(n);function n(){return Object(U.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}}]),n}(J);function G(){return H.apply(this,arguments)}function H(){return(H=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new q.a.Query(X),e.abrupt("return",t.find().then((function(e){return e.map((function(e){return new Z(e)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(p.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=new q.a.Object(X,{name:n}),e.abrupt("return",a.save().then((function(e){return new Z(e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){var e=c.a.useState([]),t=Object(a.a)(e,2),n=t[0],r=t[1],i=c.a.useState(),s=Object(a.a)(i,2),u=s[0],j=s[1];if(c.a.useState((function(){G().then((function(e){z(e).then(j)}))})),!u)return Object(g.jsx)(o.a,{children:"Loading..."});return Object(g.jsxs)(o.a,{style:{padding:25},children:[Object(g.jsx)(o.a,{style:{padding:25},children:Object(g.jsx)(w,{onStatementsSelect:function(e){r(u?function(e,t){return e.map((function(e){var n;return e.Artist=(null===(n=t[e.Artist])||void 0===n?void 0:n.mappedTo.name)||e.Artist,e}))}(e,u):e)}})}),!!n.length&&Object(g.jsxs)(o.a,{style:{padding:25,border:"solid 1px"},children:["Tracks",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(A,{sheet:n})}),"Retailers",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(B,{sheet:n})}),"Locations",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(I,{sheet:n})})]})]})}var ee=function(){return Object(g.jsx)(o.a,{className:"App",children:Object(g.jsx)($,{})})},te=n(13),ne=n(348),ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,809)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};function re(e){var t=e.manager,n=e.statementArtists,r=c.a.useState({}),i=Object(a.a)(r,2),s=i[0],u=i[1],j=c.a.useState({}),l=Object(a.a)(j,2),d=l[0],p=l[1],f=c.a.useState([]),h=Object(a.a)(f,2),b=h[0],O=h[1],m=c.a.useCallback((function(){var e=t.sortNames(n),a=e.artists,r=e.mapped,c=e.neither;p(a),u(r),O(c)}),[t,n]);return c.a.useEffect((function(){m()}),[m]),Object(g.jsxs)(o.a,{children:[Object(g.jsx)(se,{names:b,manager:t,onUpdate:m}),Object(g.jsx)(ce,{artists:d}),Object(g.jsx)(ie,{mappings:s})]})}function ce(e){var t=e.artists;return Object(g.jsxs)(o.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(o.a,{children:Object(g.jsx)("b",{children:"Artists"})}),Object(g.jsx)(o.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(g.jsx)(o.a,{children:e.name})}))})]})}function ie(e){var t=e.mappings;return Object(g.jsxs)(o.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(o.a,{children:Object(g.jsx)("b",{children:"Mappings"})}),Object(g.jsx)(o.a,{padding:"10px",children:Object.values(t).map((function(e){return Object(g.jsxs)(o.a,{children:[e.name,Object(g.jsx)("b",{children:" MAPPED TO: "}),e.mappedTo.name]})}))})]})}function se(e){var t=e.names,n=e.manager,a=e.onUpdate;return Object(g.jsxs)(o.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(o.a,{children:Object(g.jsx)("b",{children:"Unknown Artists"})}),Object(g.jsx)(o.a,{padding:"10px",children:t.map((function(e){return Object(g.jsx)(ue,{manager:n,name:e,onUpdate:a})}))})]})}function ue(e){var t=e.name,n=e.manager,r=e.onUpdate,i=c.a.useState(!1),s=Object(a.a)(i,2),u=s[0],l=s[1];return Object(g.jsxs)(o.a,{children:[Object(g.jsxs)(o.a,{children:[t,Object(g.jsx)(j.a,{onClick:function(){n.createArtist({name:t}).then(r)},children:"Import"}),Object(g.jsx)(j.a,{onClick:function(){return l(!0)},children:"Map To Existing"})]}),u&&Object(g.jsx)(oe,{manager:n,onSelect:function(e){n.createMapping({name:t,mappedTo:e}).then(r)}})]})}function oe(e){var t=e.manager,n=e.onSelect,r=c.a.useState(),i=Object(a.a)(r,2),s=i[0],u=i[1];return Object(g.jsxs)(o.a,{children:[Object(g.jsx)(N.a,{value:s,onChange:function(e){return u(e.target.value)},children:Object.keys(t.artistsByName).map((function(e){return Object(g.jsx)(E.a,{value:e,children:e},e)}))}),s&&Object(g.jsx)(j.a,{onClick:function(){return n(t.artistForName(s))},children:"Map It"})]})}var je=function(){function e(t,n){Object(U.a)(this,e),this.artistsByName=void 0,this.mappingsByName=void 0,this.artistsByName=t.reduce((function(e,t){return e[t.name]=t,e}),{}),this.mappingsByName=n}return Object(P.a)(e,[{key:"createArtist",value:function(e){var t=this;return function(e){return V.apply(this,arguments)}(e).then((function(e){return t.artistsByName[e.name]=e,e}))}},{key:"createMapping",value:function(e){var t=this;return function(e){return W.apply(this,arguments)}(e).then((function(e){return t.mappingsByName[e.name]=e,e}))}},{key:"artistForName",value:function(e){return this.artistsByName[e]}},{key:"mappingForName",value:function(e){return this.mappingsByName[e]}},{key:"sortNames",value:function(e){var t=this;return e.reduce((function(e,n){var a=e.artists,r=e.mapped,c=e.neither;return t.artistsByName[n]?a[n]=t.artistsByName[n]:t.mappingsByName[n]?r[n]=t.mappingsByName[n]:c.push(n),{artists:a,mapped:r,neither:c}}),{artists:{},mapped:{},neither:[]})}}]),e}();function le(){var e=c.a.useState([]),t=Object(a.a)(e,2),n=t[0],r=t[1],i=c.a.useState(),s=Object(a.a)(i,2),u=s[0],j=s[1];return c.a.useEffect((function(){G().then((function(e){return z(e).then((function(t){j(new je(e,t))}))}))}),[]),u?Object(g.jsxs)(o.a,{children:[Object(g.jsx)(o.a,{children:"Artist Management"}),Object(g.jsx)(o.a,{children:Object(g.jsx)(w,{label:"Import File Data",onStatementsSelect:function(e){r(function(e){return Array.from(new Set(e.map((function(e){return e.Artist}))))}(e))}})}),Object(g.jsx)(re,{manager:u,statementArtists:n})]}):Object(g.jsx)(o.a,{children:"Loading..."})}var de=n(251),pe=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,a,r,c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,r=n,c=a,e.prev=3,e.next=6,q.a.User.signUp(r,c,{});case 6:return i=e.sent,alert("Success! User ".concat(i.getUsername()," was successfully created!")),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),alert("Error! ".concat(e.t0)),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}();function fe(){var e=c.a.useState(""),t=Object(a.a)(e,2),n=t[0],r=t[1],i=c.a.useState(""),s=Object(a.a)(i,2),u=s[0],l=s[1];return Object(g.jsxs)(o.a,{children:[Object(g.jsx)(o.a,{children:"Login"}),Object(g.jsxs)(o.a,{children:["Username",Object(g.jsx)(de.a,{value:n,onChange:function(e){return r(e.target.value)}})]}),Object(g.jsxs)(o.a,{children:["Password",Object(g.jsx)(de.a,{value:u,onChange:function(e){return l(e.target.value)}})]}),Object(g.jsx)(o.a,{children:Object(g.jsx)(j.a,{onClick:function(){return pe({username:n,password:u})},children:"Signup"})})]})}function he(e){var t=e.children;return Object(g.jsx)(o.a,{padding:"35px",children:t})}function be(e){var t=e.children,n=c.a.useState(),r=Object(a.a)(n,2),i=r[0],s=r[1],u=Object(te.f)();return c.a.useEffect((function(){var e=q.a.User.current();e||u("/stream-line"),s(e)}),[u]),i?Object(g.jsx)(o.a,{children:t}):Object(g.jsx)(o.a,{})}q.a.initialize("ynIkTAKDSN7mx79IDrjsSm7yJJU43RsJe3fg3YKs","2rY3C47KmEDJ5ja3QmtObRzIYIL4dXYZ72A9Eq4W"),q.a.serverURL="https://parseapi.back4app.com/",s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(ne.a,{children:Object(g.jsx)(he,{children:Object(g.jsxs)(te.c,{children:[Object(g.jsx)(te.a,{path:"/stream-line",element:Object(g.jsx)(ee,{})}),Object(g.jsx)(te.a,{path:"/artist-management",element:Object(g.jsx)(be,{children:Object(g.jsx)(le,{})})}),Object(g.jsx)(te.a,{path:"/login",element:Object(g.jsx)(fe,{})})]})})})}),document.getElementById("root")),ae()}},[[760,1,2]]]);
//# sourceMappingURL=main.98170c6d.chunk.js.map