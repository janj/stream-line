(this["webpackJsonpstream-line"]=this["webpackJsonpstream-line"]||[]).push([[0],{263:function(e,t){},378:function(e,t,n){},379:function(e,t,n){},384:function(e,t){},385:function(e,t){},706:function(e,t){},760:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),i=n.n(c),s=(n(378),n(5)),u=n(13),o=(n(379),n(31)),p=n(806),j=n(132),l=n(24),d=n.n(l),f=n(49);function h(e){return b.apply(this,arguments)}function b(){return(b=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(n){var r,a=null===(r=n.target)||void 0===r?void 0:r.result;e({name:t.name,data:a})},r.onerror=n,r.readAsBinaryString(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.reduce((function(e,t){return e.then((function(e){return h(t).then((function(t){var n=t.name,r=t.data;return e[n]=r,e}))}))}),Promise.resolve({})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(183),v={Artist:["artist"],ContentType:["content type"],DeliveryMethod:["delivery method","product"],Distributor:["distributor","store","service"],ISRC:["isrc"],Label:["label"],PeriodFrom:["period from","sales start date"],PeriodTo:["period to","sales end date"],Quantity:["quantity","total plays"],ReleaseTitle:["release title","album name","release"],Revenue:["revenue","amount"],Territory:["territory","country iso"],TrackTitle:["track title","track name","track"],Date:["date","transaction date"],UPC:["upc","ean/upc"],CountryName:["country name"],TotalDownloads:["total downloads"],AmountCurrency:["amount currency"],Ignore:["cat. no.","suitebeats comp."]};function x(e){var t={};return Object.keys(e).forEach((function(n){var r=Object.keys(v).find((function(e){return v[e].includes(n.toLowerCase())}));r?"Ignore"!==r&&(t[r]=e[n]):console.log("not mapping:",n,e[n])})),t}function y(e,t){var n={};return t.forEach((function(t){!n[t[e]]&&(n[t[e]]=[]),n[t[e]].push(t)})),n}var g=n(3);function w(e){var t=e.label,n=e.onLoad,r=a.a.useState(!1),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState([]),l=Object(s.a)(o,2),d=l[0],f=l[1];return i?Object(g.jsxs)(p.a,{children:[Object(g.jsxs)(j.a,{variant:"contained",component:"label",children:["Select Files",Object(g.jsx)("input",{type:"file",onChange:function(e){f(Array.from(e.target.files))},hidden:!0,multiple:!0})]}),!!d.length&&Object(g.jsxs)(p.a,{border:"1px solid",padding:"5px",children:[Object(g.jsx)(p.a,{children:"Selected Files:"}),Object(g.jsxs)(p.a,{padding:"5px",children:[d.map((function(e,t){return Object(g.jsx)(p.a,{children:e.name},t)})),Object(g.jsx)(p.a,{children:Object(g.jsx)(j.a,{onClick:function(){(function(e){return O.apply(this,arguments)})(d).then(n).then((function(){return u(!1)}))},children:t||"DoIt"})})]})]})]}):Object(g.jsx)(p.a,{children:Object(g.jsx)(j.a,{variant:"contained",component:"label",onClick:function(){return u(!0)},children:"Select Files"})})}function S(e){var t=e.onStatementsSelect,n=e.label;return Object(g.jsx)(w,{onLoad:function(e){var n=Object.values(e).reduce((function(e,t){return e.push.apply(e,Object(o.a)(function(e){var t=Object.values(v).reduce((function(e,t){return e.push.apply(e,Object(o.a)(t)),e}),[]),n=m.read(e,{type:"binary"}),r=n.SheetNames[0],a=n.Sheets[r],c=m.utils.decode_range(a["!ref"]),i=m.utils.sheet_to_csv(a,{RS:"\n"}),s=-1;if(i.split("\n").forEach((function(e,n){if(!(s>=0)){var r=e.split(",").filter((function(e){return!!e}));r.filter((function(e){return t.includes(e.toLowerCase())})).length>r.length/2&&(s=n)}})),s<0)throw new Error("header row not found");return m.utils.sheet_to_json(a,{range:{s:{c:0,r:s},e:c.e}}).map(x)}(t))),e}),[]);t(n)},label:n})}var k=n(347);function C(e){var t=e.sheet,n=y("ISRC",t),r=Object.keys(n).map((function(e,t){var r={id:t};return n[e].forEach((function(e){r.title=e.TrackTitle,!r.quantity&&(r.quantity=0),r.quantity+=e.Quantity,!r.revenue&&(r.revenue=0),r.revenue+=e.Revenue,r.artist=e.Artist})),r}));return Object(g.jsx)("div",{style:{height:300,width:"100%"},children:Object(g.jsx)(k.a,{rows:r,columns:[{field:"title",headerName:"Title",width:150},{field:"artist",headerName:"Artist",width:150},{field:"quantity",headerName:"Quantity",width:150},{field:"revenue",headerName:"Revenue",width:150}]})})}var A=n(220),E=n.n(A),N=n(221),T=n(84),R="all",U=["streams","revenue"];function L(e){var t=e.sheet,n=e.onFiltersChanged,r=a.a.useState(""),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState(""),j=Object(s.a)(o,2),l=j[0],d=j[1],f=a.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1];return a.a.useEffect((function(){var e=[];t.forEach((function(t){t.Artist&&!e.includes(t.Artist)&&e.push(t.Artist)})),O(e),u(R),d(U[0])}),[t]),a.a.useEffect((function(){n({artist:i,streamOrRevenue:l})}),[l,i,n]),Object(g.jsxs)(p.a,{children:[Object(g.jsxs)(N.a,{value:i,onChange:function(e){return u(e.target.value)},style:{padding:6,margin:6},children:[Object(g.jsx)(T.a,{value:R,children:"All"}),b.map((function(e){return Object(g.jsx)(T.a,{value:e,children:e},e)}))]}),Object(g.jsx)(N.a,{value:l,onChange:function(e){return d(e.target.value)},style:{padding:6,margin:6},children:U.map((function(e){return Object(g.jsx)(T.a,{value:e,children:e},e)}))})]})}function B(e){var t=e.sheet,n=a.a.useState({}),r=Object(s.a)(n,2),c=r[0],i=r[1],u=a.a.useState([]),o=Object(s.a)(u,2),j=o[0],l=o[1],d=a.a.useState([]),f=Object(s.a)(d,2),h=f[0],b=f[1],O=a.a.useState(""),m=Object(s.a)(O,2),v=m[0],x=m[1],w=a.a.useState({}),S=Object(s.a)(w,2),k=S[0],C=S[1],A=a.a.useState(""),N=Object(s.a)(A,2),T=N[0],U=N[1];a.a.useEffect((function(){var e=y("Distributor",t),n=[];Object.keys(e).forEach((function(e){n.push(e)})),i(e),b(n)}),[t]),a.a.useEffect((function(){var e=[],t=[];Object.keys(c).forEach((function(n){var r=0,a=0;c[n].forEach((function(e){v!==R&&v!==e.Artist||(r+=e.Revenue,a+=e.Quantity)})),e.push(r),t.push(a)})),C({revenue:e,streams:t}),l([{data:t}])}),[v,c]),a.a.useEffect((function(){k[T]&&l([{data:k[T]}])}),[T,k]);var B={chart:{type:"bar",height:350},plotOptions:{bar:{borderRadius:4,horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:h}};return Object(g.jsxs)(p.a,{children:[Object(g.jsx)(L,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;x(t),U(n)}}),Object(g.jsx)(E.a,{options:B,series:j,type:"bar",height:350})]})}function F(e){var t=e.sheet,n=a.a.useState({}),r=Object(s.a)(n,2),c=r[0],i=r[1],u=a.a.useState([]),j=Object(s.a)(u,2),l=j[0],d=j[1],f=a.a.useState(""),h=Object(s.a)(f,2),b=h[0],O=h[1],m=a.a.useState(""),v=Object(s.a)(m,2),x=v[0],w=v[1],S=a.a.useState([]),k=Object(s.a)(S,2),C=k[0],A=k[1],N=a.a.useState({}),T=Object(s.a)(N,2),U=T[0],B=T[1];a.a.useEffect((function(){var e=function(e){return y("Territory",e)}(t);d(Object.keys(e)),i(e)}),[t]),a.a.useEffect((function(){var e=[],t=[];Object.keys(c).forEach((function(n){var r=0,a=0;c[n].forEach((function(e){b!==R&&b!==e.Artist||(r+=e.Revenue,a+=e.Quantity)})),e.push(r),t.push(a)})),B({revenue:e,streams:t})}),[b,c]),a.a.useEffect((function(){U[x]&&A(Object(o.a)(U[x]))}),[x,U]);return Object(g.jsxs)(p.a,{children:[Object(g.jsx)(L,{sheet:t,onFiltersChanged:function(e){var t=e.artist,n=e.streamOrRevenue;O(t),w(n)}}),Object(g.jsx)(E.a,{options:{chart:{type:"donut"},labels:l,responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},series:C,type:"donut",height:350+Math.floor(2*Math.random())+1})]})}var I=n(66),M=n(67),D=n(130),P=n(129),Q=n(48),q=n.n(Q),J=function(){function e(t){Object(I.a)(this,e),this.parseObj=void 0,this.parseObj=t}return Object(M.a)(e,[{key:"id",get:function(){return this.parseObj.id}}]),e}(),_="ArtistMapping",Y=function(e){Object(D.a)(n,e);var t=Object(P.a)(n);function n(e,r){var a;return Object(I.a)(this,n),(a=t.call(this,e)).artist=void 0,a.artist=r,a}return Object(M.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}},{key:"mappedTo",get:function(){return this.artist}}]),n}(J);function z(e){return K.apply(this,arguments)}function K(){return(K=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reduce((function(e,t){return e[t.id]=t,e}),{}),r=new q.a.Query(_),e.abrupt("return",r.find().then((function(e){return e.reduce((function(e,t){var r=new Y(t,n[t.get("mappedTo").id]);return e[r.name]=r,e}),{})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(f.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.mappedTo,a=new q.a.Object(_,{name:n,mappedTo:r.parseObj}),e.abrupt("return",a.save().then((function(e){return new Y(e,r)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W="Artist",X=function(e){Object(D.a)(n,e);var t=Object(P.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(M.a)(n,[{key:"name",get:function(){return this.parseObj.get("name")}}]),n}(J);function Z(){return G.apply(this,arguments)}function G(){return(G=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new q.a.Query(W),e.abrupt("return",t.find().then((function(e){return e.map((function(e){return new X(e)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=new q.a.Object(W,{name:n}),e.abrupt("return",r.save().then((function(e){return new X(e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){var e=a.a.useState([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(),i=Object(s.a)(c,2),u=i[0],o=i[1];if(a.a.useState((function(){Z().then((function(e){z(e).then(o)}))})),!u)return Object(g.jsx)(p.a,{children:"Loading..."});return Object(g.jsxs)(p.a,{style:{padding:25},children:[Object(g.jsx)(p.a,{style:{padding:25},children:Object(g.jsx)(S,{onStatementsSelect:function(e){r(u?function(e,t){return e.map((function(e){var n;return e.Artist=(null===(n=t[e.Artist])||void 0===n?void 0:n.mappedTo.name)||e.Artist,e}))}(e,u):e)}})}),!!n.length&&Object(g.jsxs)(p.a,{style:{padding:25,border:"solid 1px"},children:["Tracks",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(C,{sheet:n})}),"Retailers",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(B,{sheet:n})}),"Locations",Object(g.jsx)("div",{style:{padding:25},children:Object(g.jsx)(F,{sheet:n})})]})]})}var ee=n(252);function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.prev=1,e.next=4,q.a.User.signUp(n,r,{});case 4:return e.next=6,q.a.User.current();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(1),alert("Error! ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.prev=1,e.next=4,q.a.User.logIn(n,r);case 4:return e.next=6,q.a.User.current();case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(1),alert("Error! ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function ce(){return ie.apply(this,arguments)}function ie(){return(ie=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q.a.User.logOut());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){var t=e.manager,n=e.statementArtists,r=a.a.useState({}),c=Object(s.a)(r,2),i=c[0],u=c[1],o=a.a.useState({}),j=Object(s.a)(o,2),l=j[0],d=j[1],f=a.a.useState([]),h=Object(s.a)(f,2),b=h[0],O=h[1],m=a.a.useCallback((function(){var e=t.sortNames(n),r=e.artists,a=e.mapped,c=e.neither;d(r),u(a),O(c)}),[t,n]);return a.a.useEffect((function(){m()}),[m]),Object(g.jsxs)(p.a,{children:[Object(g.jsx)(pe,{names:b,manager:t,onUpdate:m}),Object(g.jsx)(ue,{artists:l}),Object(g.jsx)(oe,{mappings:i})]})}function ue(e){var t=e.artists;return Object(g.jsxs)(p.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(p.a,{children:Object(g.jsx)("b",{children:"Artists"})}),Object(g.jsx)(p.a,{padding:"10px",children:Object.values(t).map((function(e,t){return Object(g.jsx)(p.a,{children:e.name},t)}))})]})}function oe(e){var t=e.mappings;return Object(g.jsxs)(p.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(p.a,{children:Object(g.jsx)("b",{children:"Mappings"})}),Object(g.jsx)(p.a,{padding:"10px",children:Object.values(t).map((function(e,t){return Object(g.jsxs)(p.a,{children:[e.name,Object(g.jsx)("b",{children:" MAPPED TO: "}),e.mappedTo.name]},t)}))})]})}function pe(e){var t=e.names,n=e.manager,r=e.onUpdate;return Object(g.jsxs)(p.a,{border:"solid 1px",padding:"5px",children:[Object(g.jsx)(p.a,{children:Object(g.jsx)("b",{children:"Unknown Artists"})}),Object(g.jsx)(p.a,{padding:"10px",children:t.map((function(e){return Object(g.jsx)(je,{manager:n,name:e,onUpdate:r})}))})]})}function je(e){var t=e.name,n=e.manager,r=e.onUpdate,c=a.a.useState(!1),i=Object(s.a)(c,2),u=i[0],o=i[1];return Object(g.jsxs)(p.a,{children:[Object(g.jsxs)(p.a,{children:[t,Object(g.jsx)(j.a,{onClick:function(){n.createArtist({name:t}).then(r)},children:"Import"}),Object(g.jsx)(j.a,{onClick:function(){return o(!0)},children:"Map To Existing"})]}),u&&Object(g.jsx)(le,{manager:n,onSelect:function(e){n.createMapping({name:t,mappedTo:e}).then(r)}})]})}function le(e){var t=e.manager,n=e.onSelect,r=a.a.useState(),c=Object(s.a)(r,2),i=c[0],u=c[1];return Object(g.jsxs)(p.a,{children:[Object(g.jsx)(N.a,{value:i,onChange:function(e){return u(e.target.value)},children:Object.keys(t.artistsByName).map((function(e){return Object(g.jsx)(T.a,{value:e,children:e},e)}))}),i&&Object(g.jsx)(j.a,{onClick:function(){return n(t.artistForName(i))},children:"Map It"})]})}var de=function(){function e(t,n){Object(I.a)(this,e),this.artistsByName=void 0,this.mappingsByName=void 0,this.artistsByName=t.reduce((function(e,t){return e[t.name]=t,e}),{}),this.mappingsByName=n}return Object(M.a)(e,[{key:"createArtist",value:function(e){var t=this;return function(e){return V.apply(this,arguments)}(e).then((function(e){return t.artistsByName[e.name]=e,e}))}},{key:"createMapping",value:function(e){var t=this;return function(e){return H.apply(this,arguments)}(e).then((function(e){return t.mappingsByName[e.name]=e,e}))}},{key:"artistForName",value:function(e){return this.artistsByName[e]}},{key:"mappingForName",value:function(e){return this.mappingsByName[e]}},{key:"sortNames",value:function(e){var t=this;return e.reduce((function(e,n){var r=e.artists,a=e.mapped,c=e.neither;return t.artistsByName[n]?r[n]=t.artistsByName[n]:t.mappingsByName[n]?a[n]=t.mappingsByName[n]:c.push(n),{artists:r,mapped:a,neither:c}}),{artists:{},mapped:{},neither:[]})}}]),e}();var fe={login:function(){var e=a.a.useState(""),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(""),i=Object(s.a)(c,2),u=i[0],o=i[1],l=a.a.useState(),h=Object(s.a)(l,2),b=h[0],O=h[1];function m(){return(m=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:O(void 0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te({username:n,password:u});case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re({username:n,password:u});case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return a.a.useEffect((function(){O(q.a.User.current())}),[]),a.a.useEffect((function(){r(""),o("")}),[b]),b?Object(g.jsxs)(p.a,{children:[Object(g.jsxs)(p.a,{children:["Hi ",b.getUsername()]}),Object(g.jsx)(p.a,{children:Object(g.jsx)(j.a,{onClick:function(){return m.apply(this,arguments)},children:"Log Out"})})]}):Object(g.jsxs)(p.a,{children:[Object(g.jsx)(p.a,{children:"Login"}),Object(g.jsxs)(p.a,{display:"flex",justifyContent:"center",children:[Object(g.jsx)(p.a,{paddingRight:"10px",children:"Username"}),Object(g.jsx)(ee.a,{value:n,onChange:function(e){return r(e.target.value)}})]}),Object(g.jsxs)(p.a,{display:"flex",justifyContent:"center",children:[Object(g.jsx)(p.a,{paddingRight:"10px",children:"Password"}),Object(g.jsx)(ee.a,{value:u,onChange:function(e){return o(e.target.value)}})]}),Object(g.jsxs)(p.a,{children:[Object(g.jsx)(j.a,{onClick:function(){return v.apply(this,arguments)},children:"Signup"}),Object(g.jsx)(j.a,{onClick:function(){return x.apply(this,arguments)},children:"Login"})]})]})},artists:function(){var e=a.a.useState([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useState(),i=Object(s.a)(c,2),u=i[0],o=i[1];return a.a.useEffect((function(){Z().then((function(e){return z(e).then((function(t){o(new de(e,t))}))}))}),[]),u?Object(g.jsxs)(p.a,{children:[Object(g.jsx)(p.a,{children:"Artist Management"}),Object(g.jsx)(p.a,{children:Object(g.jsx)(S,{label:"Import File Data",onStatementsSelect:function(e){r(function(e){return Array.from(new Set(e.map((function(e){return e.Artist}))))}(e))}})}),Object(g.jsx)(se,{manager:u,statementArtists:n})]}):Object(g.jsx)(p.a,{children:"Loading..."})}},he=["artists"];function be(){for(var e=function(){var e=Object(u.e)().search;return a.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=q.a.User.current(),n=0,r=Object.entries(fe);n<r.length;n++){var c=Object(s.a)(r[n],2),i=c[0],o=c[1];if(e.has(i)&&(t||!he.includes(i)))return o}return $}var Oe=function(){var e=be();return Object(g.jsx)(p.a,{className:"App",padding:"35px",children:Object(g.jsx)(e,{})})},me=n(248),ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,809)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};q.a.initialize("ynIkTAKDSN7mx79IDrjsSm7yJJU43RsJe3fg3YKs","2rY3C47KmEDJ5ja3QmtObRzIYIL4dXYZ72A9Eq4W"),q.a.serverURL="https://parseapi.back4app.com/",i.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(me.a,{children:Object(g.jsx)(u.c,{children:Object(g.jsx)(u.a,{path:"/stream-line",element:Object(g.jsx)(Oe,{})})})})}),document.getElementById("root")),ve(console.log)}},[[760,1,2]]]);
//# sourceMappingURL=main.b2502cdc.chunk.js.map