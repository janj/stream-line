{"version":3,"sources":["components/Helpers.ts","components/FileSelector.tsx","components/TrackDetails.tsx","components/Retailers.tsx","components/Locations.tsx","components/Home.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["toAmpSheet","rowObj","Artist","ContentType","DeliveryMethod","Distributor","ISRC","Label","PeriodFrom","PeriodTo","Quantity","ReleaseTitle","Revenue","SuitebeatsComp","Territory","TrackTitle","UPC","getMultiByKeyProp","key","data","byKeyProp","forEach","row","push","FileSelector","onLoad","loadFiles","toLoad","loaded","length","reader","FileReader","onload","e","target","result","name","slice","onerror","ex","console","log","readAsBinaryString","Button","variant","component","type","onChange","files","i","hidden","multiple","TrackDetails","sheet","byIsrc","rows","Object","keys","map","isrc","id","track","col1","col2","col3","style","height","width","columns","field","headerName","Retailers","byRetailer","getByRetailer","categories","retailer","total","reduce","acc","options","chart","plotOptions","bar","borderRadius","horizontal","dataLabels","enabled","xaxis","series","Locations","byLocation","getByLocation","locations","labels","responsive","breakpoint","legend","position","Home","React","useState","setSheet","padding","values","sheetData","workbook","XLSX","sheetName","SheetNames","workSheet","Sheets","sheetRange","decode_range","testJson","sheet_to_csv","RS","startIndex","split","some","index","filter","h","sheet_to_json","range","s","c","r","loadAMPsuite","border","App","className","exact","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","basename","process","document","getElementById"],"mappings":"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","file":"static/js/main.27c05342.chunk.js","sourcesContent":["import * as XLSX from 'xlsx'\nimport { AmpSheetRow } from '../Types'\n\ninterface AmpSheetRaw {\n  Artist: string\n  'Content Type': string\n  'Delivery Method': string\n  Distributor: string\n  ISRC: string\n  Label: string\n  'Period From': string\n  'Period To': string\n  Quantity: string\n  'Release Title': string\n  Revenue: number\n  'Suitebeats Comp.': string\n  'Territory': string\n  'Track Title': string\n  UPC: string\n}\n\nfunction toAmpSheet(rowObj: AmpSheetRaw) {\n  return {\n    Artist: rowObj.Artist,\n    ContentType: rowObj['Content Type'],\n    DeliveryMethod: rowObj['Delivery Method'],\n    Distributor: rowObj.Distributor,\n    ISRC: rowObj.ISRC,\n    Label: rowObj.Label,\n    PeriodFrom: rowObj['Period From'],\n    PeriodTo: rowObj['Period To'],\n    Quantity: rowObj.Quantity,\n    ReleaseTitle: rowObj['Release Title'],\n    Revenue: rowObj.Revenue,\n    SuitebeatsComp: rowObj['Suitebeats Comp.'],\n    Territory: rowObj.Territory,\n    TrackTitle: rowObj['Track Title'],\n    UPC: rowObj.UPC\n  }\n}\n\nexport function loadAMPsuite(data: any): AmpSheetRow[] {\n  const workbook = XLSX.read(data, {\n    type: 'binary'\n  });\n  const sheetName = workbook.SheetNames[0]\n  const workSheet = workbook.Sheets[sheetName]\n  const sheetRange = XLSX.utils.decode_range(workSheet['!ref']!)\n  const testJson = XLSX.utils.sheet_to_csv(workSheet, { RS: '\\n'})\n  let startIndex = 0\n  testJson.split('\\n').some((row, index) => {\n    const fullCols = row.split(',').filter((h) => !!h)\n    // the first row with more than 10 cols is hopefully header row\n    if (fullCols.length > 10 && !startIndex) {\n      startIndex = index\n      return\n    }\n  })\n  const asJson = XLSX.utils.sheet_to_json<AmpSheetRaw>(workSheet, { range: { s: { c:0, r:startIndex }, e: sheetRange.e}})\n  return asJson.map(toAmpSheet)\n}\n\nexport function getByIsrc(data: AmpSheetRow[]) {\n  return getMultiByKeyProp('ISRC', data)\n}\n\nexport function getByTerritory(data: AmpSheetRow[]) {\n  return getMultiByKeyProp('Territory', data)\n}\n\nexport function getByArtist(data: AmpSheetRow[]) {\n  return getMultiByKeyProp('Artist', data)\n}\n\nexport function getByRetailer(data: AmpSheetRow[]) {\n  return getMultiByKeyProp('Distributor', data)\n}\n\nexport function getByLocation(data: AmpSheetRow[]) {\n  return getMultiByKeyProp('Territory', data)\n}\n\nexport function getMultiByKeyProp(key: keyof AmpSheetRow, data: AmpSheetRow[]) {\n  const byKeyProp: {[key: string]: AmpSheetRow[]} = {}\n  data.forEach((row) => {\n    !byKeyProp[row[key]] && (byKeyProp[row[key]] = [])\n    byKeyProp[row[key]].push(row)\n  })\n  return byKeyProp\n}\n\nexport function consolidateRvByDate(data: AmpSheetRow[]) {\n  const byDate: { [key: string]: number } = {}\n  data?.forEach((d) => {\n    !byDate[d.PeriodTo] && (byDate[d.PeriodTo] = 0)\n    byDate[d.PeriodTo] += d.Revenue\n  })\n  return byDate\n}\n","import React from 'react';\nimport { Button } from '@material-ui/core';\n\nexport default function FileSelector({ onLoad }: { onLoad: (data: any) => void }) {\n  function loadFiles(toLoad: any[], loaded: {[key: string]: any} = {}) {\n    if (!toLoad.length) {\n      onLoad(loaded)\n      return\n    }\n    const reader = new FileReader();\n    reader.onload = function(e) {\n      const data = e.target?.result;\n      loaded[toLoad[0].name] = data\n      loadFiles(toLoad.slice(1), loaded)\n    }\n    reader.onerror = function(ex) {\n      console.log(ex);\n    };\n    reader.readAsBinaryString(toLoad[0]);\n  }\n\n  function filesSelected(e: any) {\n    const files = []\n    for (let i=0; i<e.target.files.length; i++) {\n      files.push(e.target.files[i])\n    }\n    loadFiles(files)\n  }\n\n  return <Button\n    variant=\"contained\"\n    component=\"label\"\n  >\n    Upload Files\n    <input\n      type=\"file\"\n      onChange={filesSelected}\n      hidden\n      multiple\n    />\n  </Button>\n}\n","import { DataGrid, GridColDef, GridRowData, GridRowsProp } from '@material-ui/data-grid'\nimport { AmpSheetRow } from '../Types'\nimport { getByIsrc } from './Helpers'\n\nexport default function TrackDetails({ sheet }: { sheet: AmpSheetRow[]}) {\n  const cols: GridColDef[] = [\n    { field: 'col1', headerName: 'Title', width: 150 },\n    { field: 'col2', headerName: 'Quantity', width: 150 },\n    { field: 'col3', headerName: 'Revenue', width: 150 }\n  ]\n\n  const byIsrc = getByIsrc(sheet)\n  const rows: GridRowsProp = Object.keys(byIsrc).map((isrc, i) => {\n    const data: GridRowData = { id: i }\n    byIsrc[isrc].forEach((track) => {\n      data.col1 = track.TrackTitle\n      !data.col2 && (data.col2 = 0)\n      data.col2 += track.Quantity\n      !data.col3 && (data.col3 = 0)\n      data.col3 += track.Revenue\n    })\n    return data\n  })\n\n  return <div style={{ height: 300, width: '100%' }}>\n    <DataGrid rows={rows} columns={cols}></DataGrid>\n  </div>\n}\n","import ReactApexChart from 'react-apexcharts'\nimport { AmpSheetRow } from '../Types'\nimport { getByRetailer } from './Helpers'\nimport { ApexOptions } from 'apexcharts'\n\nexport default function Retailers({ sheet }: { sheet: AmpSheetRow[] }) {\n  const byRetailer = getByRetailer(sheet)\n  const categories: string[] = []\n  const data: number[] = []\n  Object.keys(byRetailer).forEach((retailer) => {\n    categories.push(retailer)\n    const total = byRetailer[retailer].reduce((acc, track) => {\n      return acc + track.Revenue\n    }, 0)\n    data.push(total)\n  })\n\n  const options: ApexOptions = {\n    chart: {\n      type: 'bar',\n      height: 350\n    },\n    plotOptions: {\n      bar: {\n        borderRadius: 4,\n        horizontal: true,\n      }\n    },\n    dataLabels: {\n      enabled: false\n    },\n    xaxis: {\n      categories,\n    }\n  }\n  const series = [{ data }]\n  return <div>\n    <ReactApexChart options={options} series={series} type=\"bar\" height={350} />\n  </div>\n}\n","import { AmpSheetRow } from '../Types'\nimport { getByLocation } from './Helpers'\nimport { ApexOptions } from 'apexcharts'\nimport ReactApexChart from 'react-apexcharts'\n\nexport default function Locations({ sheet }: { sheet: AmpSheetRow[] }) {\n  const byLocation = getByLocation(sheet)\n  const locations: string[] = []\n  const data: number[] = []\n  Object.keys(byLocation).forEach((retailer) => {\n    locations.push(retailer)\n    const total = byLocation[retailer].reduce((acc, track) => {\n      return acc + track.Revenue\n    }, 0)\n    data.push(total)\n  })\n\n  const options: ApexOptions = {\n    chart: {\n      type: 'donut',\n    },\n    labels: locations,\n    responsive: [{\n      breakpoint: 480,\n      options: {\n        chart: {\n          width: 200\n        },\n        legend: {\n          position: 'bottom'\n        }\n      }\n    }]\n  }\n\n  return <div>\n    <ReactApexChart options={options} series={data} type=\"donut\" height={350} />\n  </div>\n}\n","import React from 'react';\nimport { AmpSheetRow } from '../Types'\nimport { loadAMPsuite } from './Helpers'\nimport FileSelector from './FileSelector'\nimport TrackDetails from './TrackDetails'\nimport Retailers from './Retailers'\nimport Locations from './Locations'\n\nexport default function Home() {\n  const [sheet, setSheet] = React.useState<AmpSheetRow[]>([])\n\n  function fileSelected(data: any) {\n    const rows: AmpSheetRow[] = []\n    Object.values(data).forEach((sheetData) => {\n      rows.push(...loadAMPsuite(sheetData))\n    })\n    setSheet(rows)\n  }\n\n  return <div style={{ padding: 25 }}>\n    <div style={{ padding: 25 }}>\n      <FileSelector onLoad={fileSelected} />\n    </div>\n    {!!sheet.length && <div style={{ padding: 25, border: 'solid 1px' }}>\n      Tracks\n      <div style={{ padding: 25 }}>\n        <TrackDetails sheet={sheet} />\n      </div>\n      Retailers\n      <div style={{ padding: 25 }}>\n        <Retailers sheet={sheet} />\n      </div>\n      Locations\n      <div style={{ padding: 25 }}>\n        <Locations sheet={sheet} />\n      </div>\n    </div>\n    }\n  </div>\n}\n","import React from 'react';\nimport { Route, Switch } from \"react-router-dom\";\nimport './App.css';\nimport Home from './components/Home'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Switch>\n        <Route exact path=\"/\">\n          <Home />\n        </Route>\n      </Switch>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}